---
title: "ANOVAs_GlasserAtlas"
author: "Arielle Keller"
date: "8/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(width=250)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lsr)
```

# ANOVA on residual correlations. This is a 3-way repeated-measure ANOVA with "Lobe" (Frontal, Parietal, Temporal, Occipital), "Hemisphere" (left vs right) and "AttendIgnore" (attend preferred category, ignore preferred category). In all cases, I am collapsing across the 4 object categories/VTC regions (faces, houses, bodies, words).


```{r, include=FALSE}
setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Resid_excludeVTC.csv")
```


## Residual Correlations ANOVA results with interactions:
```{r}
summary(aov(ResidualCorrelations ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data))
```


## Calculate partial eta squared to get effect size
```{r}
etaSquared(aov(ResidualCorrelations ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data), type = 2, anova = FALSE )
```


## Plot significant main effects: Lobe
```{r}
df.summary <- data %>%
     group_by(Lobe) %>%
     summarise(
         se = sd(ResidualCorrelations, na.rm = TRUE)/sqrt(length(ResidualCorrelations)),
         ResidualCorrelations = mean(ResidualCorrelations))

ggplot(df.summary, aes(x=Lobe,y=ResidualCorrelations,fill=as.factor(Lobe))) +
  geom_bar(stat="identity") +xlab("Lobe") + ylab("Residual Correlations") +
  geom_errorbar(aes(ymin=ResidualCorrelations-se, ymax=ResidualCorrelations+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Lobe",
                         breaks=c("1", "2", "3","4"),
                         labels=c("Frontal","Parietal","Temporal","Occipital"))

```


## Plot significant main effects: Hemisphere
```{r}
df.summary <- data %>%
     group_by(Hemisphere) %>%
     summarise(
         se = sd(ResidualCorrelations, na.rm = TRUE)/sqrt(length(ResidualCorrelations)),
         ResidualCorrelations = mean(ResidualCorrelations))

ggplot(df.summary, aes(x=Hemisphere,y=ResidualCorrelations,fill=as.factor(Hemisphere))) +
  geom_bar(stat="identity") +xlab("Hemisphere") + ylab("Residual Correlations") +
  geom_errorbar(aes(ymin=ResidualCorrelations-se, ymax=ResidualCorrelations+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Hemisphere",
                         breaks=c("1", "2"),
                         labels=c("Left","Right"))
```


## Plot significant main effects: Attend vs. Ignore
```{r}
df.summary <- data %>%
     group_by(AttendIgnore) %>%
     summarise(
         se = sd(ResidualCorrelations, na.rm = TRUE)/sqrt(length(ResidualCorrelations)),
         ResidualCorrelations = mean(ResidualCorrelations))

ggplot(df.summary, aes(x=AttendIgnore,y=ResidualCorrelations,fill=as.factor(AttendIgnore))) +
  geom_bar(stat="identity") +xlab("Attend vs. Ignore") + ylab("Residual Correlations") +
  geom_errorbar(aes(ymin=ResidualCorrelations-se, ymax=ResidualCorrelations+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Condition",
                         breaks=c("1", "2"),
                         labels=c("Attend","Ignore"))
```


## Plot significant interactions: Hemisphere x Attend/Ignore
```{r}
df.summary <- data %>%
     group_by(AttendIgnore,Hemisphere) %>%
     summarise(
         se = sd(ResidualCorrelations, na.rm = TRUE)/sqrt(length(ResidualCorrelations)),
         ResidualCorrelations = mean(ResidualCorrelations))

ggplot(df.summary, aes(x=AttendIgnore,y=ResidualCorrelations,fill=as.factor(Hemisphere))) +
  geom_bar(stat="identity",position="dodge") +xlab("Attend vs. Ignore") + ylab("Residual Correlations") + geom_errorbar(aes(ymin=ResidualCorrelations-se, ymax=ResidualCorrelations+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Hemisphere",
                         breaks=c("1", "2"),
                         labels=c("Left","Right"))
```


## Plot significant interactions: Lobe x Attend/Ignore
```{r}
df.summary <- data %>%
     group_by(AttendIgnore,Lobe) %>%
     summarise(
         se = sd(ResidualCorrelations, na.rm = TRUE)/sqrt(length(ResidualCorrelations)),
         ResidualCorrelations = mean(ResidualCorrelations))

ggplot(df.summary, aes(x=AttendIgnore,y=ResidualCorrelations,fill=as.factor(Lobe))) +
  geom_bar(stat="identity",position="dodge") +xlab("Attend vs. Ignore") + ylab("Residual Correlations") + geom_errorbar(aes(ymin=ResidualCorrelations-se, ymax=ResidualCorrelations+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Lobe",
                         breaks=c("1", "2", "3","4"),
                         labels=c("Frontal","Parietal","Temporal","Occipital"))
```


## Make Figure showing results
```{r}
df.summary <- data %>%
     group_by(AttendIgnore,Lobe,Hemisphere) %>%
     summarise(
         se = sd(ResidualCorrelations, na.rm = TRUE)/sqrt(length(ResidualCorrelations)),
         ResidualCorrelations = mean(ResidualCorrelations))

df.summary$Lobe <- c(4,4,3,3,2,2,1,1,4,4,3,3,2,2,1,1) #re-order the lobes to match other figures

ggplot(df.summary, aes(x=factor(Lobe,labels=c("Occipital","Temporal","Parietal","Frontal")),y=ResidualCorrelations,fill=as.factor(interaction(AttendIgnore,Lobe)))) +
  geom_bar(stat="identity",position="dodge") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +xlab("Lobe") + ylab("Residual Correlations") + geom_errorbar(aes(ymin=ResidualCorrelations-se, ymax=ResidualCorrelations+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_manual(name="Condition",
                         values = c(rgb(103/255,129/255,186/255),rgb(70/255,179/255,143/255),rgb(180/255,92/255,111/255),rgb(246/255,125/255,73/255),rgb(205/255,213/255,228/255),rgb(185/255,220/255,200/255),rgb(242/255,215/255,222/255),rgb(248/255,215/255,178/255)),
                         breaks=c("1.1", "1.2", "1.3", "1.4", "2.1", "2.2", "2.3", "2.4"),
                         labels=c("Attended","Attended","Attended","Attended","Ignored","Ignored", "Ignored","Ignored")) + facet_wrap(~ factor(Hemisphere,labels=c("Left Hemisphere","Right Hemisphere"))) + geom_segment(aes(x=0.5,xend=4.58,y=0.01,yend=0.01),linetype="dashed")
```


```{r,echo=FALSE}
data2<-data
data2$Lobe <- factor(data2$Lobe)
data2$Hemisphere <- factor(data2$Hemisphere)
data2$AttendIgnore <- factor(data2$AttendIgnore)
TUKEY_LobeMainEffect <- TukeyHSD(x=aov(ResidualCorrelations ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'Lobe', conf.level=0.95)
TUKEY_HemiMainEffect <- TukeyHSD(x=aov(ResidualCorrelations ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'Hemisphere', conf.level=0.95)
TUKEY_CondMainEffect <- TukeyHSD(x=aov(ResidualCorrelations ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'AttendIgnore', conf.level=0.95)
TUKEY_CondHemiInteraction <- TukeyHSD(x=aov(ResidualCorrelations ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'AttendIgnore:Hemisphere', conf.level=0.95)
TUKEY_CondLobeInteraction <- TukeyHSD(x=aov(ResidualCorrelations ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'Lobe:AttendIgnore', conf.level=0.95)
```

## Post-Hoc Tukey HSD tests
```{r}
TUKEY_LobeMainEffect
TUKEY_HemiMainEffect
TUKEY_CondMainEffect
TUKEY_CondHemiInteraction
TUKEY_CondLobeInteraction
```


# ANOVA on classification accuracy. This is a 3-way repeated-measure ANOVA with "Lobe" (Frontal, Parietal, Temporal, Occipital), "Hemisphere" (left vs right) and "AttendIgnore" (attend preferred category, ignore preferred category). In all cases, I am collapsing across the 4 object categories/VTC regions (faces, houses, bodies, words).


```{r, include=FALSE}
setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Class_excludeVTC.csv")
```


## Classification Accuracy ANOVA results with interactions:
```{r}
summary(aov(ClassificationAccuracy ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data))
```



## Calculate partial eta squared to get effect size
```{r}
etaSquared(aov(ClassificationAccuracy ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data), type = 2, anova = FALSE )
```


## Plot significant main effects: Lobe
```{r}
df.summary <- data %>%
     group_by(Lobe) %>%
     summarise(
         se = sd(ClassificationAccuracy, na.rm = TRUE)/sqrt(length(ClassificationAccuracy)),
         ClassificationAccuracy = mean(ClassificationAccuracy))

ggplot(df.summary, aes(x=Lobe,y=ClassificationAccuracy,fill=as.factor(Lobe))) +
  geom_bar(stat="identity") +xlab("Lobe") + ylab("Classification Accuracy") +
  geom_errorbar(aes(ymin=ClassificationAccuracy-se, ymax=ClassificationAccuracy+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Lobe",
                         breaks=c("1", "2", "3","4"),
                         labels=c("Frontal","Parietal","Temporal","Occipital"))
```


## Plot significant main effects: Attend vs. Ignore
```{r}
df.summary <- data %>%
     group_by(AttendIgnore) %>%
     summarise(
         se = sd(ClassificationAccuracy, na.rm = TRUE)/sqrt(length(ClassificationAccuracy)),
         ClassificationAccuracy = mean(ClassificationAccuracy))

ggplot(df.summary, aes(x=AttendIgnore,y=ClassificationAccuracy,fill=as.factor(AttendIgnore))) +
  geom_bar(stat="identity") +xlab("Attend vs. Ignore") + ylab("Classification Accuracy") +
  geom_errorbar(aes(ymin=ClassificationAccuracy-se, ymax=ClassificationAccuracy+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Condition",
                         breaks=c("1", "2"),
                         labels=c("Attend","Ignore"))
```


## Plot significant interactions: Lobe x Attend/Ignore
```{r}
df.summary <- data %>%
     group_by(AttendIgnore,Lobe) %>%
     summarise(
         se = sd(ClassificationAccuracy, na.rm = TRUE)/sqrt(length(ClassificationAccuracy)),
         ClassificationAccuracy = mean(ClassificationAccuracy))

ggplot(df.summary, aes(x=AttendIgnore,y=ClassificationAccuracy,fill=as.factor(Lobe))) +
  geom_bar(stat="identity",position="dodge") +xlab("Attend vs. Ignore") + ylab("Classification Accuracy") + geom_errorbar(aes(ymin=ClassificationAccuracy-se, ymax=ClassificationAccuracy+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_discrete(name="Lobe",
                         breaks=c("1", "2", "3","4"),
                         labels=c("Frontal","Parietal","Temporal","Occipital"))
```


```{r,echo=FALSE}
data2<-data
data2$Lobe <- factor(data2$Lobe)
data2$Hemisphere <- factor(data2$Hemisphere)
data2$AttendIgnore <- factor(data2$AttendIgnore)
TUKEY_LobeMainEffect <- TukeyHSD(x=aov(ClassificationAccuracy ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'Lobe', conf.level=0.95)
TUKEY_CondMainEffect <- TukeyHSD(x=aov(ClassificationAccuracy ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'AttendIgnore', conf.level=0.95)
TUKEY_CondLobeInteraction <- TukeyHSD(x=aov(ClassificationAccuracy ~ Lobe+AttendIgnore+Hemisphere+Lobe:AttendIgnore+Lobe:Hemisphere+AttendIgnore:Hemisphere+Lobe:Hemisphere:AttendIgnore, data=data2), 'Lobe:AttendIgnore', conf.level=0.95)
```


## Post-Hoc Tukey HSD tests
```{r}
TUKEY_LobeMainEffect
TUKEY_CondMainEffect
TUKEY_CondLobeInteraction
```

## Make Figure showing results
```{r}
df.summary <- data %>%
     group_by(AttendIgnore,Lobe,Hemisphere) %>%
     summarise(
         se = sd(ClassificationAccuracy, na.rm = TRUE)/sqrt(length(ClassificationAccuracy)),
         ClassificationAccuracy = mean(ClassificationAccuracy))

df.summary$Lobe <- c(4,4,3,3,2,2,1,1,4,4,3,3,2,2,1,1)

ggplot(df.summary, aes(x=factor(Lobe,labels=c("Occipital","Temporal","Parietal","Frontal")),y=ClassificationAccuracy,fill=as.factor(interaction(AttendIgnore,Lobe)))) +
  geom_bar(stat="identity",position="dodge") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +xlab("Lobe") + ylab("Classification Accuracy") + geom_errorbar(aes(ymin=ClassificationAccuracy-se, ymax=ClassificationAccuracy+se), width=.2,
                 position=position_dodge(.9)) + scale_fill_manual(name="Condition",
                         values = c(rgb(103/255,129/255,186/255),rgb(70/255,179/255,143/255),rgb(180/255,92/255,111/255),rgb(246/255,125/255,73/255),rgb(205/255,213/255,228/255),rgb(185/255,220/255,200/255),rgb(242/255,215/255,222/255),rgb(248/255,215/255,178/255)),
                         breaks=c("1.1", "1.2", "1.3", "1.4", "2.1", "2.2", "2.3", "2.4"),
                         labels=c("Attended","Attended","Attended","Attended","Ignored","Ignored", "Ignored","Ignored")) + facet_wrap(~ factor(Hemisphere,labels=c("Left Hemisphere","Right Hemisphere")))+ geom_segment(aes(x=0.5,xend=4.58,y=0.2,yend=0.2),linetype="dashed")

```


```{r}
# add an rmANOVA in each lobe with factors of ROIxCond to see if there's an interaction
setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Resid_excludeVTC.csv")
lobe1 <- data[data$Lobe==1,]
lobe2 <- data[data$Lobe==2,]
lobe3 <- data[data$Lobe==3,]
lobe4 <- data[data$Lobe==4,]
lobe1LH <-lobe1[lobe1$Hemisphere==1,]
lobe2LH <-lobe2[lobe2$Hemisphere==1,]
lobe3LH <-lobe3[lobe3$Hemisphere==1,]
lobe4LH <-lobe4[lobe4$Hemisphere==1,]
lobe1RH <-lobe1[lobe1$Hemisphere==2,]
lobe2RH <-lobe2[lobe2$Hemisphere==2,]
lobe3RH <-lobe3[lobe3$Hemisphere==2,]
lobe4RH <-lobe4[lobe4$Hemisphere==2,]
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe1LH))
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe2LH))
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe3LH))
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe4LH))
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe1RH))
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe2RH))
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe3RH))
summary(aov(ResidualCorrelations ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe4RH))

setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Class_excludeVTC.csv")
lobe1 <- data[data$Lobe==1,]
lobe2 <- data[data$Lobe==2,]
lobe3 <- data[data$Lobe==3,]
lobe4 <- data[data$Lobe==4,]
lobe1LH <-lobe1[lobe1$Hemisphere==1,]
lobe2LH <-lobe2[lobe2$Hemisphere==1,]
lobe3LH <-lobe3[lobe3$Hemisphere==1,]
lobe4LH <-lobe4[lobe4$Hemisphere==1,]
lobe1RH <-lobe1[lobe1$Hemisphere==2,]
lobe2RH <-lobe2[lobe2$Hemisphere==2,]
lobe3RH <-lobe3[lobe3$Hemisphere==2,]
lobe4RH <-lobe4[lobe4$Hemisphere==2,]
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe1LH))
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe2LH))
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe3LH))
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe4LH))
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe1RH))
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe2RH))
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe3RH))
summary(aov(ClassificationAccuracy ~ AttendIgnore+RegionID+AttendIgnore:RegionID, data=lobe4RH))
```


## Compute a correlation between attended residuals and ignored residuals (and do the same for classification accuracy)

```{r}
setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Resid_excludeVTC_avgOverSubjects.csv")
attended.resid <-data[data$AttendIgnore==1,1]
ignored.resid <-data[data$AttendIgnore==2,1]
data.AttIg <-data.frame(attended.resid,ignored.resid)
cor.test(attended.resid,ignored.resid)

ggplot(data.AttIg, aes(x=attended.resid,y=ignored.resid)) +
   geom_point(size=1,color="cadetblue3") +
   geom_smooth(method=lm,color="dimgray") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +xlab("Attended") + ylab("Ignored") + ggtitle("(b) Residual Correlations")


setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Class_excludeVTC_avgOverSubjects.csv")
attended.class <-data[data$AttendIgnore==1,1]
ignored.class <-data[data$AttendIgnore==2,1]
data.AttIg <-data.frame(attended.class,ignored.class)
cor.test(attended.class,ignored.class)

ggplot(data.AttIg, aes(x=attended.class,y=ignored.class)) +
   geom_point(size=1,color="cadetblue3") +
   geom_smooth(method=lm,color="dimgray")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +xlab("Attended") + ylab("Ignored") + ggtitle("(a) Classification Accuracy")
```


## Repeat, but split by lobe and hemisphere, and use linear regression

```{r}

# Residual Correlations:

setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Resid_excludeVTC_avgOverSubjects.csv")
attended.resid <-data[data$AttendIgnore==1,]
ignored.resid <-data[data$AttendIgnore==2,]
attended.resid.LH <- attended.resid[attended.resid$Hemisphere==1,]
attended.resid.RH <- attended.resid[attended.resid$Hemisphere==2,]
ignored.resid.LH <- ignored.resid[ignored.resid$Hemisphere==1,]
ignored.resid.RH <- ignored.resid[ignored.resid$Hemisphere==2,]

# Linear Regressions
summary(lm(attended.resid.LH[attended.resid.LH$Lobe==1,1]~ignored.resid.LH[ignored.resid.LH$Lobe==1,1]))
summary(lm(attended.resid.LH[attended.resid.LH$Lobe==2,1]~ignored.resid.LH[ignored.resid.LH$Lobe==2,1]))
summary(lm(attended.resid.LH[attended.resid.LH$Lobe==3,1]~ignored.resid.LH[ignored.resid.LH$Lobe==3,1]))
summary(lm(attended.resid.LH[attended.resid.LH$Lobe==4,1]~ignored.resid.LH[ignored.resid.LH$Lobe==4,1]))
summary(lm(attended.resid.RH[attended.resid.RH$Lobe==1,1]~ignored.resid.RH[ignored.resid.RH$Lobe==1,1]))
summary(lm(attended.resid.RH[attended.resid.RH$Lobe==2,1]~ignored.resid.RH[ignored.resid.RH$Lobe==2,1]))
summary(lm(attended.resid.RH[attended.resid.RH$Lobe==3,1]~ignored.resid.RH[ignored.resid.RH$Lobe==3,1]))
summary(lm(attended.resid.RH[attended.resid.RH$Lobe==4,1]~ignored.resid.RH[ignored.resid.RH$Lobe==4,1]))

# Classification Accuracy:

setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data <- read.csv("data_ANOVA_Glasser_Class_excludeVTC_avgOverSubjects.csv")
attended.class <-data[data$AttendIgnore==1,]
ignored.class <-data[data$AttendIgnore==2,]
attended.class.LH <- attended.class[attended.class$Hemisphere==1,]
attended.class.RH <- attended.class[attended.class$Hemisphere==2,]
ignored.class.LH <- ignored.class[ignored.class$Hemisphere==1,]
ignored.class.RH <- ignored.class[ignored.class$Hemisphere==2,]

# Linear Regressions
summary(lm(attended.class.LH[attended.class.LH$Lobe==1,1]~ignored.class.LH[ignored.class.LH$Lobe==1,1]))
summary(lm(attended.class.LH[attended.class.LH$Lobe==2,1]~ignored.class.LH[ignored.class.LH$Lobe==2,1]))
summary(lm(attended.class.LH[attended.class.LH$Lobe==3,1]~ignored.class.LH[ignored.class.LH$Lobe==3,1]))
summary(lm(attended.class.LH[attended.class.LH$Lobe==4,1]~ignored.class.LH[ignored.class.LH$Lobe==4,1]))
summary(lm(attended.class.RH[attended.class.RH$Lobe==1,1]~ignored.class.RH[ignored.class.RH$Lobe==1,1]))
summary(lm(attended.class.RH[attended.class.RH$Lobe==2,1]~ignored.class.RH[ignored.class.RH$Lobe==2,1]))
summary(lm(attended.class.RH[attended.class.RH$Lobe==3,1]~ignored.class.RH[ignored.class.RH$Lobe==3,1]))
summary(lm(attended.class.RH[attended.class.RH$Lobe==4,1]~ignored.class.RH[ignored.class.RH$Lobe==4,1]))
```


## Model comparisons for correlations between residuals and classification by lobe, hemisphere, and attention

```{r}
# load data
setwd('/Users/ariellekeller/Google Drive/SelecAttnProj/ANOVAs_Glasser/')
data.RC <- read.csv("data_ANOVA_Glasser_Resid_excludeVTC_avgOverSubjects.csv")
data.CA <- read.csv("data_ANOVA_Glasser_Class_excludeVTC_avgOverSubjects.csv")
data.both <- data.CA
data.both$ResidualCorrelations <- data.RC$ResidualCorrelations
data.both.LH <- data.both[data.both$Hemisphere==1,]
data.both.RH <- data.both[data.both$Hemisphere==2,]
data.both.LH.att <- data.both.LH[data.both.LH$AttendIgnore==1,]
data.both.LH.ig <- data.both.LH[data.both.LH$AttendIgnore==2,]
data.both.RH.att <- data.both.RH[data.both.RH$AttendIgnore==1,]
data.both.RH.ig <- data.both.RH[data.both.RH$AttendIgnore==2,]

model1<-lm(data.both.LH.att$ClassificationAccuracy~data.both.LH.att$ResidualCorrelations)
model2<-lm(data.both.LH.att$ClassificationAccuracy~data.both.LH.att$ResidualCorrelations+data.both.LH.att$Lobe)
model3<-lm(data.both.LH.att$ClassificationAccuracy~data.both.LH.att$ResidualCorrelations+data.both.LH.att$Lobe+data.both.LH.att$ResidualCorrelations*data.both.LH.att$Lobe)
anova(model1,model2,test = "Chisq")
anova(model2,model3,test = "Chisq")

model1<-lm(data.both.RH.att$ClassificationAccuracy~data.both.RH.att$ResidualCorrelations)
model2<-lm(data.both.RH.att$ClassificationAccuracy~data.both.RH.att$ResidualCorrelations+data.both.RH.att$Lobe)
model3<-lm(data.both.RH.att$ClassificationAccuracy~data.both.RH.att$ResidualCorrelations+data.both.RH.att$Lobe+data.both.RH.att$ResidualCorrelations*data.both.RH.att$Lobe)
anova(model1,model2,test = "Chisq")
anova(model2,model3,test = "Chisq")

model1<-lm(data.both.LH.ig$ClassificationAccuracy~data.both.LH.ig$ResidualCorrelations)
model2<-lm(data.both.LH.ig$ClassificationAccuracy~data.both.LH.ig$ResidualCorrelations+data.both.LH.ig$Lobe)
model3<-lm(data.both.LH.ig$ClassificationAccuracy~data.both.LH.ig$ResidualCorrelations+data.both.LH.ig$Lobe+data.both.LH.ig$ResidualCorrelations*data.both.LH.ig$Lobe)
anova(model1,model2,test = "Chisq")
anova(model2,model3,test = "Chisq")


model1<-lm(data.both.RH.ig$ClassificationAccuracy~data.both.RH.ig$ResidualCorrelations)
model2<-lm(data.both.RH.ig$ClassificationAccuracy~data.both.RH.ig$ResidualCorrelations+data.both.RH.ig$Lobe)
model3<-lm(data.both.RH.ig$ClassificationAccuracy~data.both.RH.ig$ResidualCorrelations+data.both.RH.ig$Lobe+data.both.RH.ig$ResidualCorrelations*data.both.RH.ig$Lobe)
anova(model1,model2,test = "Chisq")
anova(model2,model3,test = "Chisq")
```
